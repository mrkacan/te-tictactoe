(this.webpackJsonptictactoe=this.webpackJsonptictactoe||[]).push([[0],{103:function(e,t,a){e.exports=a.p+"static/media/logo.7f18492e.png"},124:function(e,t,a){e.exports=a(223)},129:function(e,t,a){},223:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),c=a.n(o),i=a(49),s=a(7),u=a(35),l=a(36),m=a(45),d=a(44),f=(a(129),a(9)),g=a.n(f),h=a(43);function p(e){for(var t=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]],a=0;a<t.length;a++){var n=Object(h.a)(t[a],3),r=n[0],o=n[1],c=n[2];if(e[r]&&e[r]===e[o]&&e[r]===e[c])return e[r]}return null}var v=a(120).a.div({hidden:{scale:0,opacity:0},visible:{scale:1,opacity:1,transition:{opacity:{ease:"easeOut",duration:300},default:{ease:"linear",duration:500}}}});var y=function(e){return r.a.createElement("button",{className:"square ".concat(e.isMyTurn?"te-my-turn":""),onClick:e.onClick},r.a.createElement(v,{pose:"X"===e.value||"O"===e.value?"visible":"hidden"},e.value))},b=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"renderSquare",value:function(e){var t=this;return r.a.createElement(y,{isMyTurn:this.props.isMyTurn,value:this.props.squares[e],onClick:function(){return t.props.onClick(e)}})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"board-row"},this.renderSquare(0),this.renderSquare(1),this.renderSquare(2)),r.a.createElement("div",{className:"board-row"},this.renderSquare(3),this.renderSquare(4),this.renderSquare(5)),r.a.createElement("div",{className:"board-row"},this.renderSquare(6),this.renderSquare(7),this.renderSquare(8)))}}]),a}(r.a.Component),I=a(103),E=a.n(I),C=a(224);var O=function(e){return r.a.createElement("div",{className:"te-logo-header"},r.a.createElement("div",null,r.a.createElement("img",{className:"te-logo",src:E.a})),r.a.createElement("div",null,e.isLoading&&r.a.createElement(C.a,null)))},w=a(82),S=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).isMyTurn=function(){var e=n.props.currentUserId;return n.props.gameConfig.nextPlayer===e},n.isItMyRoom=function(){var e=n.props.currentUserId;return n.props.gameConfig.ownerId===e},n.getOtherPlayer=function(){var e=n.props.currentUserId,t=n.props.gameConfig,a=t.ownerId,r=t.otherPlayerId,o="";return e===a&&(o=r),e===r&&(o=a),console.log("ownerId",a),console.log("otherPlayerId",r),console.log("currentUserId",e),o},n.getNextPlayer=function(){var e=n.props.gameConfig.nextPlayer;return e||""},n.getWinnerName=function(e){var t=n.props.gameConfig,a=t.X,r=t.O;return"X"===e?a:r},n.isGameFineshed=function(){return!1},n.state={X:"",Y:"",ownerId:"",otherPlayerId:"",Winner:"",ownerWin:0,otherPlayerWin:0,nextPlayer:"",history:new Array(9).fill(null),stepNumber:0,xIsNext:!0,isLoading:!1,xWantPlay:!0,yWantPlay:!0},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.gameConfig;this.setState(Object(s.a)({},this.state,{},e))}},{key:"handleClick",value:function(e){var t=this,a=this.state.history,n=this.props,r=n.updateGame,o=n.gameConfig.X,c=n.currentUserId;console.log("history",a),console.log("this.isMyTurn()",this.isMyTurn());var i=Object(s.a)({},a);!this.isMyTurn()||p(a)||a[e]||(i[e]=o===c?"X":"O",this.setState({history:i},(function(){r({history:i,nextPlayer:t.getOtherPlayer()})})))}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.isLoading,o=a.history,c=(a.ownerWin,this.props),i=c.gameConfig,s=(c.currentUserId,c.roomId,c.updateGame),u=p(o),l=this.isMyTurn(),m=this.isItMyRoom(),d=this.getNextPlayer(),f=u||this.isGameFineshed();return i?(e=u?"Winner: "+u:"Next player: "+d,f&&(e="Game has finished. Waiting for room owner for start game."),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"game"},n?r.a.createElement(O,{isLoading:!0}):r.a.createElement("div",{className:"game-board"},r.a.createElement(b,{squares:o,onClick:function(e){return t.handleClick(e)},isMyTurn:l}))),r.a.createElement("div",null,n?null:r.a.createElement("div",{className:"game-info"},r.a.createElement("div",null,e))),!f&&r.a.createElement("h3",{className:"m-4 text-center"},l?"Your Turn!":"Waiting opponent."),m&&r.a.createElement(w.a,{onClick:function(){return s({history:[]})}},"Start Again"),u&&r.a.createElement("h1",null,"WINNER ".concat(this.getWinnerName(u),"!")))):r.a.createElement(O,{isLoading:!0})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.gameConfig.history,n=e.updateGame,r=e.gameConfig;e.yWantPlay;r&&a&&(p(a)&&n({xWantPlay:!1,yWantPlay:!1}));return console.log("props.gameConfig",e.gameConfig),Object(s.a)({},e.gameConfig)}}]),a}(r.a.Component);S.defaultProps={gameConfig:{X:"",Y:"",ownerId:"",otherPlayerId:"",Winner:"",ownerWin:0,otherPlayerWin:0,nextPlayer:""}};var N=S,j=a(226),k=a(16),x=a.n(k),R=a(50),P={setItem:function(){var e=Object(R.a)(x.a.mark((function e(t,a){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,localStorage.setItem(t,JSON.stringify(a));case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),getItem:function(){var e=Object(R.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,localStorage.getItem(t);case 3:return a=e.sent,e.abrupt("return",JSON.parse(a));case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),removeItem:function(){var e=Object(R.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,localStorage.removeItem(t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),clear:function(){var e=Object(R.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("####_LOCAL_STORAGE_CLEARED_####"),e.next=4,localStorage.clear().then((function(){return localStorage.setItem("isFirstTime","NO")}));case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}()};var U=function(e){var t=e.checkUser,a=Object(n.useState)(""),o=Object(h.a)(a,2),c=o[0],i=o[1];return r.a.createElement("div",{className:"te-register-form d-flex justify-content-center align-items-center"},r.a.createElement("div",null,r.a.createElement(O,null),r.a.createElement(j.a,{size:"large",placeholder:"username",onChange:function(e){return i(e.target.value.toLowerCase())},className:"text-center",value:c,spellCheck:!1,autoFocus:!0}),r.a.createElement(w.a,{className:"mt-2",type:"primary",block:!0,onClick:function(){t(c)}},"CONTINUE")))};var W=function(e){var t=e.checkRoom,a=Object(n.useState)(""),o=Object(h.a)(a,2),c=o[0],i=o[1];return r.a.createElement("div",{className:"te-register-form d-flex justify-content-center align-items-center"},r.a.createElement("div",null,r.a.createElement(O,null),r.a.createElement(j.a,{size:"large",placeholder:"room id (4 digit)",onChange:function(e){return(""===(t=e.target.value)||!!(t&&t.length<5))&&i(e.target.value);var t},className:"text-center",value:c,max:4,type:"number",autoFocus:!0}),r.a.createElement(w.a,{disabled:4!==c.length,className:"mt-2",type:"primary",block:!0,onClick:function(){c&&4===c.length&&t(c)}},"JOIN & CREATE ROOM")))},L=a(225),T=a(113),M=a.n(T);var q=function(e){var t=e.currentUserId,a=e.logout,n=e.currentRoom;return r.a.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},r.a.createElement("div",{className:"d-flex align-items-center"},r.a.createElement(L.a,{className:"te-avatar"},t.charAt(0).toUpperCase()),r.a.createElement("div",{className:"d-flex align-items-start flex-column"},r.a.createElement("div",{className:"te-active-user ml-2"},"user: "+t),n?r.a.createElement("div",{className:"te-active-user ml-2"},"room code: "+n):null)),r.a.createElement("div",{onClick:a,className:"cursor-pointer te-logout"},"Logout ",r.a.createElement(M.a,{size:"medium"})))},A=a(227),G={X:"",O:"",ownerId:"",otherPlayerId:"",Winner:"",ownerWin:0,otherPlayerWin:0,nextPlayer:"",history:new Array(9).fill(null),stepNumber:0,xIsNext:!0,xWantPlay:!0,yWantPlay:!0},F=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).checkUser=function(){P.getItem("userId").then((function(e){P.getItem("currentRoom").then((function(t){e&&n.setState({currentUserId:e,isRegistered:!0,currentRoom:t}),t&&e&&n.runGameListeners(),n.setState({isLoading:!1})}))}))},n.registerUser=function(e){n.setState({isLoading:!0}),g.a.database().ref("users/".concat(e)).once("value",(function(t){t.val()?(A.a.error("This user already exist. Please try with other username"),n.setState({isLoading:!1})):g.a.database().ref("users/".concat(e)).update({userActive:!0}).then((function(){P.setItem("userId",e).then((function(){n.setState({currentUserId:e,isRegistered:!0,currentRoom:null,isLoading:!1})}))}))}))},n.checkRoom=function(e){var t=n.state.currentUserId;n.setState({isLoading:!0}),g.a.database().ref("rooms/".concat(e)).once("value",(function(a){var r=a.val(),o=Object(s.a)({},G,{X:t,ownerId:t,nextPlayer:t});r?g.a.database().ref("rooms/".concat(e)).once("value",(function(a){g.a.database().ref("rooms/".concat(e)).update({otherPlayerId:t,O:t}).then((function(){P.setItem("currentRoom",e).then((function(){n.setState({currentRoom:e,gameConfig:a.val(),isLoading:!1}),A.a.success("Successfully joined.")}))}))})):g.a.database().ref("rooms/".concat(e)).update(o).then((function(){P.setItem("currentRoom",e).then((function(){n.setState({currentRoom:e,gameConfig:o,isLoading:!1}),A.a.info("Room successfully created. Share your codes for join.\n"+"Your code: ".concat(e))}))}))}))},n.logout=function(){P.removeItem("userId").then((function(){P.removeItem("currentRoom").then((function(){n.setState({currentUserId:null,isRegistered:!1,currentRoom:null})}))}))},n.runGameListeners=function(){P.getItem("userId").then((function(e){P.getItem("currentRoom").then((function(t){e&&t&&(n.setState({currentUserId:e,isRegistered:!0,currentRoom:t}),g.a.database().ref("rooms/".concat(t)).once("value",(function(e){var t=e.val();n.setState((function(e){return Object(s.a)({},e,{gameConfig:Object(s.a)({},e.gameConfig,{},t,{history:t.history?t.history:new Array(9).fill(null)})})}))})),g.a.database().ref("rooms/".concat(t)).on("child_changed",(function(e){var t=e;console.log("gameConfig",t),n.setState((function(e){return Object(s.a)({},e,{gameConfig:Object(s.a)({},e.gameConfig,Object(i.a)({},t.key,t.val()))})}))})),g.a.database().ref("rooms/".concat(t)).on("child_added",(function(e){var t=e;n.setState((function(e){return Object(s.a)({},e,{gameConfig:Object(s.a)({},e.gameConfig,Object(i.a)({},t.key,t.val()))})}))})),g.a.database().ref("rooms/".concat(t,"/history")).on("child_removed",(function(e){n.setState((function(e){return Object(s.a)({},e,{gameConfig:Object(s.a)({},e.gameConfig,{history:[]})})}))})))}))}))},n.updateGame=function(e){var t=n.state.currentRoom;g.a.database().ref("rooms/".concat(t)).update(e)},n.state={isRegistered:!1,currentUserId:null,currentRoom:null,gameConfig:Object(s.a)({},G),isLoading:!0,appIsRunning:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){setTimeout(function(){this.checkUser()}.bind(this),1500),window.addEventListener("resize",(function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))}))}},{key:"render",value:function(){var e=this.state,t=e.isRegistered,a=e.currentUserId,n=e.currentRoom,o=e.roomId,c=e.gameConfig,i=e.isLoading;return i?r.a.createElement(O,{isLoading:i}):t?n?r.a.createElement(r.a.Fragment,null,r.a.createElement(q,{currentUserId:a,currentRoom:n,logout:this.logout}),r.a.createElement(N,{currentUserId:a,roomId:o,gameConfig:c,isRoomOwner:c&&c.ownerId===a,updateGame:this.updateGame})):r.a.createElement(r.a.Fragment,null,r.a.createElement(q,{currentUserId:a,logout:this.logout}),r.a.createElement(W,{checkRoom:this.checkRoom})):r.a.createElement(U,{checkUser:this.registerUser})}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var X=a(228),D=(a(215),a(216),X.a.Content);g.a.initializeApp({apiKey:"AIzaSyDQtpaeFhvUUeUtUUxA4xlDaEzDiSo7fHc",authDomain:"te-tictactoe.firebaseapp.com",databaseURL:"https://te-tictactoe.firebaseio.com",projectId:"te-tictactoe",storageBucket:"te-tictactoe.appspot.com",messagingSenderId:"478023561910",appId:"1:478023561910:web:81e0297885e6397316ec17",measurementId:"G-LB8CWZC46J"}),c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(X.a,{className:"layout te-game-layout"},r.a.createElement(D,{className:"te-game-content"},r.a.createElement("div",{className:"site-layout-content"},r.a.createElement(F,null))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[124,1,2]]]);
//# sourceMappingURL=main.28693d6e.chunk.js.map